{"name": "整夜房远期预定流程测试", "status": "broken", "statusDetails": {"message": "Exception", "trace": "self = <testcases.test_night_order.TestNightOrder object at 0x10e615910>, name = '逍遥', phone = '15800978440', room_type = '影院双床立方', start_date = '18', end_date = '19', except_result = {'expect_result': [{'房费总额': '¥158.00'}, {'实付金额': '¥158.00'}, {'总价': '¥158.00'}, {'入住人': '逍遥'}]}\n\n    @allure.title(\"整夜房远期预定流程测试\")\n    @pytest.mark.parametrize((\"name\", \"phone\", \"room_type\", \"start_date\", \"end_date\", \"except_result\"),\n                             get_data('test_forward_night_order', '../data/pro_data/test_overnight_order.yaml'))\n    def test_forward_night_order(self, name, phone, room_type, start_date, end_date, except_result):\n        \"\"\"\n        远期预定流程\n        :param name: 入住人\n        :param phone: 电话号码\n        :param room_type: 房型名称\n        :param start_date: 开始日期\n        :param end_date: 结束日期\n        :param except_result: 期望结果集\n        :return: None\n        \"\"\"\n        with allure.step(f\"{start_date}日：{room_type}-整夜房下单流程\"):\n>           hotel_scheduled = self.main.set_night_date(\n                start_date, end_date).goto_night_hotel_list().goto_hotel_detail().goto_hotel_scheduled(\n                room_type).save_order(name,\n                                      phone)\n\n../testcases/test_night_order.py:162: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../pages/hotellist.py:12: in goto_hotel_detail\n    self.step('../data/hotel_list.yaml')\n../pages/basepage.py:118: in step\n    element = self.find(step.get('selector'), step.get('params'))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = (<pages.hotellist.HotelList testMethod=runTest>, '.img', {'max_timeout': 30}), kwargs = {}, BasePage = <class 'pages.basepage.BasePage'>, _black_list = [], _max_error_count = 3, _error_count = 4, instance = <pages.hotellist.HotelList testMethod=runTest>, element = None, filename = '150123791024.png'\nf = <_io.BufferedReader name='../screenshot/150123791024.png'>\ncontent = b'\\x89PNG\\r\\n\\x1a\\n\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x01w\\x00\\x00\\x02[\\x08\\x02\\x00\\x00\\x00\\x90$Cy\\x00\\x00\\x01*iCCPSkia\\x00\\x0...0\\xba\\xa8\\x0c\\x00]T\\x06\\x80.*\\x03@\\x17\\x95\\x01\\xa0\\xeb\\xff\\x00\\xe6>\\x880\\xb7\\x00\\xb6\\xdc\\x00\\x00\\x00\\x00IEND\\xaeB`\\x82'\n\n    def handle(*args, **kwargs):\n        from pages.basepage import BasePage\n        # 首次进入隐私协议黑名单\n        _black_list = [\n        ]\n        # 最大重试次数\n        _max_error_count = 3\n        # 失败次数初始化\n        _error_count = 0\n        # 拿到BasePage实例对象\n        instance: BasePage = args[0]\n        log.info(\"run \" + func.__name__ + \"\\n args: \\n\" + repr(args) + \"\\n\" + repr(kwargs))\n        element = func(*args, **kwargs)\n        # 重置失败次数\n        _error_count = 0\n        if element:\n            return element\n        while not element:\n            # 错误日志\n            log.info(f\"未定位到当前元素，第{_error_count + 1}次重试\")\n            # 错误截图\n            filename = \"%s.png\" % datetime.datetime.now().strftime(\"%H%M%S%f\")\n            instance._mini.app.screen_shot(save_path=f\"../screenshot/{filename}\")\n            with open(f\"../screenshot/{filename}\", \"rb\") as f:\n                content = f.read()\n            allure.attach(content, func.__name__, attachment_type=allure.attachment_type.PNG)\n            # 缩短隐式等待时间，优化速度\n            time.sleep(1)\n            # 如果超出最大处理次数，抛出异常\n            if _error_count > _max_error_count:\n>               raise Exception\nE               Exception\n\n../pages/decorator.py:47: Exception"}, "description": "\n        远期预定流程\n        :param name: 入住人\n        :param phone: 电话号码\n        :param room_type: 房型名称\n        :param start_date: 开始日期\n        :param end_date: 结束日期\n        :param except_result: 期望结果集\n        :return: None\n        ", "steps": [{"name": "18日：影院双床立方-整夜房下单流程", "status": "broken", "statusDetails": {"message": "Exception\n", "trace": "  File \"/Users/apple/Documents/M3/m3_test/m3_mp_test/testcases/test_night_order.py\", line 162, in test_forward_night_order\n    hotel_scheduled = self.main.set_night_date(\n  File \"/Users/apple/Documents/M3/m3_test/m3_mp_test/pages/hotellist.py\", line 12, in goto_hotel_detail\n    self.step('../data/hotel_list.yaml')\n  File \"/Users/apple/Documents/M3/m3_test/m3_mp_test/pages/basepage.py\", line 118, in step\n    element = self.find(step.get('selector'), step.get('params'))\n  File \"/Users/apple/Documents/M3/m3_test/m3_mp_test/pages/decorator.py\", line 47, in handle\n    raise Exception\n"}, "attachments": [{"name": "find", "source": "4f5790fe-3014-4138-934d-0ad8fa526911-attachment.png", "type": "image/png"}, {"name": "find", "source": "6cb75b36-923d-4d27-8bf1-3fd0ef5d8c4a-attachment.png", "type": "image/png"}, {"name": "find", "source": "6dc19eb1-cbe8-4c9f-bf9f-b906ecad15c2-attachment.png", "type": "image/png"}, {"name": "find", "source": "e575c69a-32f2-431e-9100-1ad62aa9cda4-attachment.png", "type": "image/png"}, {"name": "find", "source": "d78df8c9-1394-431d-9ea5-67cfb391845d-attachment.png", "type": "image/png"}], "start": 1602658719702, "stop": 1602658884952}], "attachments": [{"name": "log", "source": "62ea6877-9c5b-4325-a2c3-624282d1ec2d-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "name", "value": "'逍遥'"}, {"name": "phone", "value": "'15800978440'"}, {"name": "room_type", "value": "'影院双床立方'"}, {"name": "start_date", "value": "'18'"}, {"name": "end_date", "value": "'19'"}, {"name": "except_result", "value": "{'expect_result': [{'房费总额': '¥158.00'}, {'实付金额': '¥158.00'}, {'总价': '¥158.00'}, {'入住人': '逍遥'}]}"}], "start": 1602658719702, "stop": 1602658884952, "uuid": "03b3a799-9c86-417e-ae42-2e93b73f6742", "historyId": "0b14379900ae8670ca189d37867ad0e8", "testCaseId": "c1e5f9c49a8bb5cb3c734901c773ebd9", "fullName": "test_night_order.TestNightOrder#test_forward_night_order", "labels": [{"name": "feature", "value": "整夜房预定订单模块"}, {"name": "suite", "value": "test_night_order"}, {"name": "subSuite", "value": "TestNightOrder"}, {"name": "host", "value": "mac-test.local"}, {"name": "thread", "value": "70307-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_night_order"}]}